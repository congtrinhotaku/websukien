<!DOCTYPE html>
<html lang="vi-VN">
<head>
    <meta charset="UTF-8">
    <title>Chi tiết sự kiện</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body
    style="background-image: url(<%= event.banner_image %>); 
    background-size: cover;     
    background-position: center;
    background-repeat: no-repeat;
    background-color: rgba(0, 0, 0, 0.8);">

    <%- include("partials/header") %>

    <div class="container mt-5 mb-5">
        <div class="row justify-content-center mt-5">
            <div class="col-lg-10 mt-5">

                <div class="card shadow border-0">
                    <div class="card-body p-4">
                        <div class="row">
                            <!-- Cột trái: ảnh + tên + mô tả -->
                            <div class="col-md-8">
                                <!-- Ảnh sự kiện -->
                                <div class="text-center mb-3">
                                    <img src="<%= event.cover_image || '/images/default_cover.jpg' %>" 
                                         alt="Ảnh sự kiện" 
                                         class="img-fluid rounded shadow"
                                         style="max-height:350px; object-fit:cover; width:100%;">
                                </div>
                                <!-- Tên sự kiện -->
                                <h1 class="text-primary mb-3"><%= event.name %></h1>
                                <!-- Mô tả -->
                                <p class="fs-5"><%= event.description %></p>
                            </div>

                            <!-- Cột phải: thông tin chi tiết -->
                            <div class="col-md-4">
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item">
                                        <strong>Bắt đầu:</strong> <br>
                                        <%= event.start_time.toLocaleString("vi-VN") %>
                                    </li>
                                    <li class="list-group-item">
                                        <strong>Kết thúc:</strong> <br>
                                        <%= event.end_time.toLocaleString("vi-VN") %>
                                    </li>
                                    <li class="list-group-item">
                                        <strong>Địa điểm:</strong> <br>
                                        <%= event.location %>
                                    </li>
                                    <li class="list-group-item bg-light border border-danger-subtle rounded shadow-sm">
                                        <strong class="text-danger-emphasis">Còn lại:</strong> <br>
                                        <span class="badge fs-3 text-center text-danger w-100 text-center">
                                            <% 
                                                const now = new Date();
                                                const diff = new Date(event.start_time) - now;
                                                let remain = "";
                                                if (diff > 0) {
                                                    const days = Math.floor(diff / (1000*60*60*24));
                                                    const hours = Math.floor((diff % (1000*60*60*24)) / (1000*60*60));
                                                    remain = `${days} ngày ${hours} giờ`;
                                                } else {
                                                    remain = "Đang diễn ra hoặc đã kết thúc";
                                                }
                                            %>
                                            <%= remain %>
                                        </span>
                                    </li>
                                    <li class="list-group-item mt-2 bg-light border border-primary rounded shadow-sm">
                                        <strong class="text-primary">
                                            Số người tham gia:
                                        </strong> 
                                        <span class="badge fs-3 text-center text-success w-100 text-center">
                                            <%= participantsCount %> người
                                        </span>
                                    </li>

                                </ul>
                                <div class="text-center mt-3">
                                    <a href="/event/invite/<%= event._id %>" 
                                       class="btn btn-success btn-lg w-100">
                                       Đăng ký tham gia
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <%- include("partials/footer") %>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>